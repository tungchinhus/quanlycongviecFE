<div class="roles-management-container">
  <div class="page-header">
    <div class="header-content">
      <div class="header-text">
        <h1>
          <mat-icon>admin_panel_settings</mat-icon>
          Quản lý Roles & Permissions
        </h1>
        <p class="page-description">Quản lý roles, permissions và gán permissions cho roles</p>
      </div>
    </div>
  </div>

  @if (!isAdmin()) {
    <mat-card class="access-denied-card">
      <div class="access-denied-content">
        <mat-icon>lock</mat-icon>
        <h2>Không có quyền truy cập</h2>
        <p>Chỉ Administrator mới có thể truy cập trang quản lý roles và permissions.</p>
      </div>
    </mat-card>
  } @else {
    <mat-tab-group class="management-tabs" animationDuration="300ms">
      <!-- Tab 1: Quản lý Roles -->
      <mat-tab label="Quản lý Roles">
        <div class="tab-content">
          @if (!selectedRole()) {
            <app-role-list (onRoleSelected)="onRoleSelectedFromList($event)"></app-role-list>
          } @else {
            <div class="role-permission-wrapper">
              <div class="selected-role-info">
                <button mat-icon-button (click)="onRoleBack()" matTooltip="Quay lại">
                  <mat-icon>arrow_back</mat-icon>
                </button>
                <span class="selected-role-name">{{ selectedRole()?.roleName }}</span>
              </div>
              
              <app-role-permission-assignment
                [role]="selectedRole()!"
                [isAdmin]="isAdmin()"
                (onPermissionUpdated)="onPermissionUpdated()">
              </app-role-permission-assignment>
            </div>
          }
        </div>
      </mat-tab>

      <!-- Tab 2: Quản lý Permissions -->
      <mat-tab label="Quản lý Permissions">
        <div class="tab-content">
          <app-permission-list></app-permission-list>
        </div>
      </mat-tab>
    </mat-tab-group>
  }
</div>

